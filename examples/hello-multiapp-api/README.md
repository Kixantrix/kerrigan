# Hello Multi-App API

A simple FastAPI service demonstrating multi-repository coordination in the Kerrigan workflow.

## Overview

This API is part of a three-repository example project:
- **hello-multiapp-api** (this repository) - Backend REST API
- **hello-multiapp-frontend** - Web frontend that consumes this API
- **hello-multiapp-infra** - Infrastructure and deployment configs

The API provides health check and version endpoints that the frontend consumes, demonstrating cross-repository coordination.

## Quick Start

### Local Development

1. **Install dependencies**:
   ```bash
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   pip install -r requirements.txt
   ```

2. **Run the API**:
   ```bash
   python main.py
   ```
   API available at: http://localhost:8000

3. **Test endpoints**:
   ```bash
   # Health check
   curl http://localhost:8000/health
   
   # Version info
   curl http://localhost:8000/version
   
   # API documentation (automatic)
   open http://localhost:8000/docs
   ```

### Docker

1. **Build image**:
   ```bash
   docker build -t hello-multiapp-api .
   ```

2. **Run container**:
   ```bash
   docker run -p 8000:8000 hello-multiapp-api
   ```

### Multi-Repo Deployment

For the complete multi-repo experience, use the infrastructure repository to deploy all services together:

```bash
# Clone all three repos side by side
mkdir hello-multiapp
cd hello-multiapp
git clone <repo-url> hello-multiapp-api
git clone <repo-url> hello-multiapp-frontend
git clone <repo-url> hello-multiapp-infra

# Deploy via infrastructure
cd hello-multiapp-infra
docker-compose up --build
```

This will start:
- API on http://localhost:8000
- Frontend on http://localhost:3000

## API Endpoints

### GET /

Service information and endpoint discovery.

**Response:**
```json
{
  "message": "Hello Multi-App API",
  "endpoints": {
    "health": "/health",
    "version": "/version",
    "docs": "/docs"
  }
}
```

### GET /health

Health check endpoint for monitoring.

**Response:**
```json
{
  "status": "ok",
  "service": "hello-multiapp-api"
}
```

### GET /version

Version information about the API.

**Response:**
```json
{
  "version": "1.0.0",
  "service": "hello-multiapp-api",
  "environment": "development"
}
```

### GET /docs

Interactive API documentation (Swagger UI) - automatically generated by FastAPI.

## Configuration

Configure via environment variables:

| Variable | Default | Description |
|----------|---------|-------------|
| `PORT` | 8000 | Port to listen on |
| `ENVIRONMENT` | development | Environment name |
| `LOG_LEVEL` | INFO | Logging level |

**Example:**
```bash
export PORT=8080
export ENVIRONMENT=production
python main.py
```

## Multi-Repo Architecture

This API is designed to work within a multi-repository architecture:

### Repository Dependencies

```
hello-multiapp-api (this repo)
    ↓ consumed by
hello-multiapp-frontend
    ↓ both deployed by
hello-multiapp-infra
```

### Cross-Repo Integration Points

1. **API Endpoints** - Frontend consumes `/health` and `/version`
2. **CORS Configuration** - Allows frontend cross-origin requests
3. **Docker Container** - Built and deployed by infra repo
4. **Health Checks** - Used by infra for container orchestration

### Coordination Artifacts

This repository includes a complete set of Kerrigan artifacts in the `specs/` folder:

- **spec.md** - Requirements and scope (includes repository references)
- **tasks.md** - Implementation tasks (includes cross-repo dependencies)
- **architecture.md** - Technical design (documents integration points)
- **runbook.md** - Deployment procedures (coordinates with infra)
- **cost-plan.md** - Cost analysis (includes shared infrastructure)

These artifacts demonstrate how multi-repo projects coordinate through documentation.

## Project Structure

```
hello-multiapp-api/
├── main.py              # FastAPI application
├── requirements.txt     # Python dependencies
├── Dockerfile          # Container definition
├── .gitignore          # Git exclusions
├── README.md           # This file
└── specs/              # Kerrigan artifacts
    ├── spec.md         # Project specification
    ├── tasks.md        # Implementation tasks
    ├── architecture.md # Architecture design
    ├── runbook.md      # Deployment guide
    └── cost-plan.md    # Cost analysis
```

## Development

### Technology Stack

- **Language**: Python 3.11+
- **Framework**: FastAPI 0.104.1
- **Server**: Uvicorn (ASGI)
- **Container**: Docker

### Why FastAPI?

- Modern async/await support
- Automatic OpenAPI documentation
- Type validation built-in
- Excellent for multi-service architectures

## Testing Integration

To test the multi-repo integration:

1. **Start the API** (this repo)
2. **Start the frontend** (hello-multiapp-frontend)
3. **Frontend automatically calls API** on page load
4. **Verify connection** in browser console

Or use Docker Compose from the infra repo for automated setup.

## Documentation

Complete project documentation in `specs/` folder:

- **Specification**: `specs/spec.md` - Project goals and requirements
- **Architecture**: `specs/architecture.md` - Technical design and integration
- **Runbook**: `specs/runbook.md` - Deployment and operations
- **Tasks**: `specs/tasks.md` - Implementation checklist
- **Cost Plan**: `specs/cost-plan.md` - Cost analysis and budgeting

## Multi-Repo Workflow Example

This project demonstrates key multi-repo patterns:

### Scenario 1: Kickoff
- Spec agent initializes all three repos
- Each spec.md references the other repos
- Tasks have cross-repo dependencies defined

### Scenario 2: Implementation
- SWE agent works on API (this repo)
- Another SWE agent works on frontend
- Changes coordinated via artifact references

### Scenario 3: Deployment
- Ops agent uses infra repo
- References runbooks from all repos
- Coordinates deployment across services

## Related Repositories

- **Frontend**: hello-multiapp-frontend - Web UI consuming this API
- **Infrastructure**: hello-multiapp-infra - Deployment and orchestration
- **Parent Project**: See root kerrigan repository for multi-repo documentation

## License

MIT (see root LICENSE file)
