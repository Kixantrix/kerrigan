# Agent Feedback - Draft PR CI Triggering

# REQUIRED FIELDS
timestamp: "2026-01-17T08:00:00Z"
issue_number: 67
agent_role: "triage"
category: "workflow_friction"
severity: "medium"
title: "Converting draft PR to ready doesn't trigger CI checks"

# REQUIRED: Detailed description
description: |
  When marking draft PRs as ready for review, CI workflows don't automatically 
  trigger, requiring manual intervention to start checks.
  
  **What happened:**
  - PRs #67, #68, #69, #74 were completed by Copilot but marked as draft
  - Used `gh pr ready <number>` to mark them as ready for review
  - Expected: CI to trigger automatically (validate, autonomy gates, etc.)
  - Actual: No CI runs started, status showed "no checks"
  
  **Workflow trigger configuration:**
  .github/workflows/ci.yml triggers on:
  - pull_request.opened
  - pull_request.synchronize
  - pull_request.reopened
  
  Missing: pull_request.ready_for_review
  
  **Current workaround:**
  - Close and reopen each PR: `gh pr close <num>; gh pr reopen <num>`
  - This triggers the "reopened" event
  - Works but adds unnecessary noise to PR timeline
  
  **Impact:**
  - Manual triage step required for every draftâ†’ready transition
  - Can't verify CI status before approval
  - Delays merge workflow by requiring extra commands

# OPTIONAL FIELDS
related_files:
  - ".github/workflows/ci.yml"
  - ".github/workflows/agent-gates.yml"
  - "playbooks/triage.md"

context: |
  This affected all 4 PRs in today's triage session:
  - PR #67: Integrate PR documentation validator
  - PR #68: Agent spec compliance checking  
  - PR #69: Task Tracker real implementation
  - PR #74: External research capabilities
  
  All were complete but stayed draft until manually marked ready.
  Required close/reopen to trigger CI before merge.

proposed_solution: |
  **Immediate fix:**
  Add `ready_for_review` trigger to workflow files:
  
  ```yaml
  on:
    pull_request:
      types: [opened, synchronize, reopened, ready_for_review]
  ```
  
  Files to update:
  - .github/workflows/ci.yml
  - .github/workflows/agent-gates.yml  
  - .github/workflows/agent-spec-compliance.yml
  - .github/workflows/auto-assign-reviewers.yml (if applicable)
  
  **Triage playbook update:**
  Document the workaround in playbooks/triage.md until fix is deployed:
  
  "If PRs marked ready don't show CI checks, close and reopen:
  `gh pr close <num> && gh pr reopen <num>`"
  
  **Alternative approach:**
  Could also add workflow_dispatch trigger for manual CI runs:
  ```yaml
  on:
    workflow_dispatch:
      inputs:
        pr_number:
          description: 'PR number to check'
          required: true
  ```

# METADATA (leave blank for new feedback)
status: "open"
reviewed_by: "copilot"
reviewed_date: "2026-01-22"
implementation_pr: null
notes: |
  Audited 2026-01-22: The ready_for_review trigger has NOT been added to workflow files.
  Checked .github/workflows/ci.yml and it still only has: opened, synchronize, reopened.
  This remains an open issue that should be addressed.
  
  Recommended action: Add ready_for_review to pull_request types in all workflow files:
  - .github/workflows/ci.yml
  - .github/workflows/agent-gates.yml
  - .github/workflows/agent-spec-compliance.yml
